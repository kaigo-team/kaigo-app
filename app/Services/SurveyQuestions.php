<?php

namespace App\Services;

/**
 * 調査項目と回答選択肢を管理するクラス
 */
class SurveyQuestions
{
    /**
     * 中間得点データ
     * 各調査項目の回答に対する中間得点を定義
     * 
     * @var array
     */
    private static $intermediateScores = [
        // 第1群 身体機能・起居動作
        '1-1' => [ // 麻痺
            'ない' => 6.5,
            'いずれか一肢のみ' => 5.5,
            '両下肢のみ' => 3.9,
            '左上下肢あるいは右上下肢' => 3.3,
            'その他の四肢の麻痺' => 0
        ],
        '1-2_肩関節' => [ // 拘縮（肩関節）
            'ない' => 2.3,
            'ある' => 0
        ],
        '1-2_股関節' => [ // 拘縮（股関節）
            'ない' => 2.7,
            'ある' => 0
        ],
        '1-2_膝関節' => [ // 拘縮（膝関節）
            'ない' => 1.1,
            'ある' => 0
        ],
        '1-3' => [ // 寝返り
            'つかまらないでできる' => 9.0,
            '何かにつかまればできる' => 6.5,
            'できない' => 0
        ],
        '1-4' => [ // 起き上がり
            'つかまらないでできる' => 8.8,
            '何かにつかまればできる' => 6.7,
            'できない' => 0
        ],
        '1-5' => [ // 座位保持
            'できる' => 10.0,
            '自分の手で支えればできる' => 8.4,
            '支えてもらえればできる' => 4.7,
            'できない' => 0
        ],
        '1-6' => [ // 両足での立位
            '支えなしでできる' => 8.7,
            '何か支えがあればできる' => 6.2,
            'できない' => 0
        ],
        '1-7' => [ // 歩行
            'つかまらないでできる' => 7.6,
            '何かにつかまればできる' => 5.5,
            'できない' => 0
        ],
        '1-8' => [ // 立ち上がり
            'つかまらないでできる' => 9.7,
            '何かにつかまればできる' => 7.1,
            'できない' => 0
        ],
        '1-9' => [ // 片足での立位
            '支えなしでできる' => 7.3,
            '何か支えがあればできる' => 5.4,
            'できない' => 0
        ],
        '1-10' => [ // 洗身
            '自立（介助なし）' => 6.2,
            '一部介助' => 4.4,
            '全介助' => 0,
            '行っていない' => 0
        ],
        '1-11' => [ // つめ切り
            '自立（介助なし）' => 4.1,
            '一部介助' => 2.8,
            '全介助' => 0
        ],
        '1-12' => [ // 視力
            '普通（日常生活に支障がない）' => 5.2,
            '約1m離れた視力確認表の図が見える' => 4.0,
            '目の前においた視力確認表の図が見える' => 2.9,
            'ほとんど見えない' => 0,
            'みえているのか判断不能' => 0
        ],
        '1-13' => [ // 聴力
            '普通' => 10.8,
            '普通の声がやっと聴き取れる' => 10.6,
            'かなり大きな声ならなんとか聴き取れる' => 9.8,
            'ほとんど聴こえない' => 9.0,
            '聴こえているのか判断不明' => 0
        ],

        // 第2群 生活機能
        '2-1' => [ // 移乗
            '自立（介助なし）' => 9.1,
            '見守り等' => 6.9,
            '一部介助' => 3.5,
            '全介助' => 0
        ],
        '2-2' => [ // 移動
            '自立（介助なし）' => 8.1,
            '見守り等' => 6.4,
            '一部介助' => 3.7,
            '全介助' => 0
        ],
        '2-3' => [ // 嚥下
            'できる' => 10.2,
            '見守り等' => 7.2,
            'できない' => 0
        ],
        '2-4' => [ // 食事摂取
            '自立（介助なし）' => 9.8,
            '見守り等' => 6.8,
            '一部介助' => 4.6,
            '全介助' => 0
        ],
        '2-5' => [ // 排尿
            '自立（介助なし）' => 7.2,
            '見守り等' => 5.9,
            '一部介助' => 5.1,
            '全介助' => 0
        ],
        '2-6' => [ // 排便
            '自立（介助なし）' => 7.2,
            '見守り等' => 5.7,
            '一部介助' => 4.9,
            '全介助' => 0
        ],
        '2-7' => [ // 口腔清潔
            '自立（介助なし）' => 9.3,
            '一部介助' => 5.2,
            '全介助' => 0
        ],
        '2-8' => [ // 洗顔
            '自立（介助なし）' => 9.0,
            '一部介助' => 5.1,
            '全介助' => 0
        ],
        '2-9' => [ // 整髪
            '自立（介助なし）' => 7.9,
            '一部介助' => 4.1,
            '全介助' => 0
        ],
        '2-10' => [ // 上衣の着脱
            '自立（介助なし）' => 9.4,
            '見守り等' => 8.0,
            '一部介助' => 5.7,
            '全介助' => 0
        ],
        '2-11' => [ // ズボン等の着脱
            '自立（介助なし）' => 8.7,
            '見守り等' => 7.3,
            '一部介助' => 5.4,
            '全介助' => 0
        ],
        '2-12' => [ // 外出頻度
            '週1回以上' => 4.1,
            '月1回以上' => 3.4,
            '月1回未満' => 0
        ],

        // 第3群 認知機能
        '3-1' => [ // 意思の伝達
            '調査対象者が意思を他者に伝達できる' => 17.7,
            'ときどき伝達できる' => 12.5,
            'ほとんど伝達できない' => 4.2,
            'できない' => 0
        ],
        '3-2' => [ // 毎日の日課を理解
            'できる' => 7.6,
            'できない' => 0
        ],
        '3-3' => [ // 生年月日を言う
            'できる' => 11.3,
            'できない' => 0
        ],
        '3-4' => [ // 短期記憶
            'できる' => 7.0,
            'できない' => 0
        ],
        '3-5' => [ // 自分の名前を言う
            'できる' => 16.3,
            'できない' => 0
        ],
        '3-6' => [ // 今の季節を理解
            'できる' => 9.1,
            'できない' => 0
        ],
        '3-7' => [ // 場所の理解
            'できる' => 11.6,
            'できない' => 0
        ],
        '3-8' => [ // 徘徊
            'ない' => 9.5,
            'ときどきある' => 2.7,
            'ある' => 0
        ],
        '3-9' => [ // 外出して戻れない
            'ない' => 9.9,
            'ときどきある' => 4.7,
            'ある' => 0
        ],

        // 第4群 精神・行動障害
        '4-1' => [ // 被害的
            'ない' => 7.0,
            'ときどきある' => 3.2,
            'ある' => 0
        ],
        '4-2' => [ // 作話
            'ない' => 8.2,
            'ときどきある' => 3.4,
            'ある' => 0
        ],
        '4-3' => [ // 感情が不安定
            'ない' => 5.0,
            'ときどきある' => 2.5,
            'ある' => 0
        ],
        '4-4' => [ // 昼夜逆転
            'ない' => 4.2,
            'ときどきある' => 1.9,
            'ある' => 0
        ],
        '4-5' => [ // 同じ話をする
            'ない' => 4.9,
            'ときどきある' => 3.0,
            'ある' => 0
        ],
        '4-6' => [ // 大声をだす
            'ない' => 7.0,
            'ときどきある' => 2.8,
            'ある' => 0
        ],
        '4-7' => [ // 介護に抵抗
            'ない' => 6.1,
            'ときどきある' => 2.4,
            'ある' => 0
        ],
        '4-8' => [ // 落ち着きなし
            'ない' => 7.8,
            'ときどきある' => 2.1,
            'ある' => 0
        ],
        '4-9' => [ // 一人で出たがる
            'ない' => 8.7,
            'ときどきある' => 2.3,
            'ある' => 0
        ],
        '4-10' => [ // 収集癖
            'ない' => 8.3,
            'ときどきある' => 1.6,
            'ある' => 0
        ],
        '4-11' => [ // 物や衣類を隠す
            'ない' => 10.7,
            'ときどきある' => 2.3,
            'ある' => 0
        ],
        '4-12' => [ // ひどい物忘れ
            'ない' => 4.0,
            'ときどきある' => 3.3,
            'ある' => 0
        ],
        '4-13' => [ // 独り言・独り笑い
            'ない' => 6.5,
            'ときどきある' => 2.3,
            'ある' => 0
        ],
        '4-14' => [ // 自分勝手に行動する
            'ない' => 6.3,
            'ときどきある' => 3.0,
            'ある' => 0
        ],
        '4-15' => [ // 話がまとまらない
            'ない' => 5.3,
            'ときどきある' => 1.9,
            'ある' => 0
        ],

        // 第5群 社会生活への適応
        '5-1' => [ // 薬の内服
            '自立（介助なし）' => 21.2,
            '一部介助' => 9.9,
            '全介助' => 0
        ],
        '5-2' => [ // 金銭の管理
            '自立（介助なし）' => 18.2,
            '一部介助' => 9.5,
            '全介助' => 0
        ],
        '5-3' => [ // 日常の意思決定
            'できる' => 22.5,
            '特別な場合を除いてできる' => 13.7,
            '日常的に困難' => 5.5,
            'できない' => 0
        ],
        '5-4' => [ // 集団への不適応
            'ない' => 6.1,
            'ときどきある' => 1.8,
            'ある' => 0
        ],
        '5-5' => [ // 買い物
            'できる（介助なし）' => 16.6,
            '見守り等' => 9.2,
            '一部介助' => 7.4,
            '全介助' => 0
        ],
        '5-6' => [ // 簡単な調理
            'できる（介助なし）' => 15.4,
            '見守り等' => 9.0,
            '一部介助' => 8.6,
            '全介助' => 0
        ]
    ];
    /**
     * 調査項目のグループを取得
     * 
     * @return array 調査項目のグループ一覧
     */
    public static function getGroups(): array
    {
        return [
            1 => '第1群　基本動作・起居動作機能の変化',
            2 => '第2群　生活機能（ADL・IADL）',
            3 => '第3群　認知機能（記憶・意思疎通）',
            4 => '第4群　社会的行動の評価',
            5 => '第5群　社会生活適応に関する評価',
            6 => '第6群　特別な医療行為',
            7 => '日常生活自立度（調査員）',
            8 => '主治医意見書（調査員）',
        ];
    }

    /**
     * 全ての調査項目を取得
     * 
     * @return array 調査項目の配列
     */
    public static function getAllQuestions(): array
    {
        return [
            // 第1群
            '1-1' => [
                'title' => '麻痺',
                'options' => ['左上肢', '右上肢', '左下肢', '右下肢', 'その他（四肢欠損）'],
                'type' => 'checkbox',
            ],
            '1-2' => [
                'title' => '拘縮',
                'options' => ['肩関節', '股関節', '膝関節', 'その他（四肢欠損）'],
                'type' => 'checkbox',
            ],
            '1-3' => [
                'title' => '寝返り',
                'options' => ['つかまらないでできる', '何かにつかまればできる', 'できない'],
                'type' => 'radio',
            ],
            '1-4' => [
                'title' => '起き上がり',
                'options' => ['つかまらないでできる', '何かにつかまればできる', 'できない'],
                'type' => 'radio',
            ],
            '1-5' => [
                'title' => '座位保持',
                'options' => ['できる', '自分の手で支えればできる', '支えてもらえればできる', 'できない'],
                'type' => 'radio',
            ],
            '1-6' => [
                'title' => '両足での立位',
                'options' => ['支えなしでできる', '何か支えがあればできる', 'できない'],
                'type' => 'radio',
            ],
            '1-7' => [
                'title' => '歩行',
                'options' => ['つかまらないでできる', '何かにつかまればできる', 'できない'],
                'type' => 'radio',
            ],
            '1-8' => [
                'title' => '立ち上がり',
                'options' => ['つかまらないでできる', '何かにつかまればできる', 'できない'],
                'type' => 'radio',
            ],
            '1-9' => [
                'title' => '片足での立位',
                'options' => ['支えなしでできる', '何か支えがあればできる', 'できない'],
                'type' => 'radio',
            ],
            '1-10' => [
                'title' => '洗身',
                'options' => ['自立（介助なし）', '一部介助', '全介助', '行っていない'],
                'type' => 'radio',
            ],
            '1-11' => [
                'title' => 'つめ切り',
                'options' => ['自立（介助なし）', '一部介助', '全介助'],
                'type' => 'radio',
            ],
            '1-12' => [
                'title' => '視力',
                'options' => ['普通（日常生活に支障がない）', '約1m離れた視力確認表の図が見える', '目の前においた視力確認表の図が見える', 'ほとんど見えない', 'みえているのか判断不能'],
                'type' => 'radio',
            ],
            '1-13' => [
                'title' => '聴力',
                'options' => ['普通', '普通の声がやっと聴き取れる', 'かなり大きな声ならなんとか聴き取れる', 'ほとんど聴こえない', '聴こえているのか判断不明'],
                'type' => 'radio',
            ],
            // 第2群
            '2-1' => [
                'title' => '移乗',
                'options' => ['自立（介助なし）', '見守り等', '一部介助', '全介助'],
                'type' => 'radio',
            ],
            '2-2' => [
                'title' => '移動',
                'options' => ['自立（介助なし）', '見守り等', '一部介助', '全介助'],
                'type' => 'radio',
            ],
            '2-3' => [
                'title' => '嚥下',
                'options' => ['できる', '見守り等', 'できない'],
                'type' => 'radio',
            ],
            '2-4' => [
                'title' => '食事摂取',
                'options' => ['自立（介助なし）', '見守り等', '一部介助', '全介助'],
                'type' => 'radio',
            ],
            '2-5' => [
                'title' => '排尿',
                'options' => ['自立（介助なし）', '見守り等', '一部介助', '全介助'],
                'type' => 'radio',
            ],
            '2-6' => [
                'title' => '排便',
                'options' => ['自立（介助なし）', '見守り等', '一部介助', '全介助'],
                'type' => 'radio',
            ],
            '2-7' => [
                'title' => '口腔清潔',
                'options' => ['自立（介助なし）', '一部介助', '全介助'],
                'type' => 'radio',
            ],
            '2-8' => [
                'title' => '洗顔',
                'options' => ['自立（介助なし）', '一部介助', '全介助'],
                'type' => 'radio',
            ],
            '2-9' => [
                'title' => '整髪',
                'options' => ['自立（介助なし）', '一部介助', '全介助'],
                'type' => 'radio',
            ],
            '2-10' => [
                'title' => '上衣の着脱',
                'options' => ['自立（介助なし）', '見守り等', '一部介助', '全介助'],
                'type' => 'radio',
            ],
            '2-11' => [
                'title' => 'ズボン等の着脱',
                'options' => ['自立（介助なし）', '見守り等', '一部介助', '全介助'],
                'type' => 'radio',
            ],
            '2-12' => [
                'title' => '外出頻度',
                'options' => ['週1回以上', '月1回以上', '月1回未満'],
                'type' => 'radio',
            ],
            // 第3群
            '3-1' => [
                'title' => '意思の伝達',
                'options' => ['調査対象者が意思を他者に伝達できる', 'ときどき伝達できる', 'ほとんど伝達できない', 'できない'],
                'type' => 'radio',
            ],
            '3-2' => [
                'title' => '毎日の日課を理解',
                'options' => ['できる', 'できない'],
                'type' => 'radio',
            ],
            '3-3' => [
                'title' => '生年月日を言う',
                'options' => ['できる', 'できない'],
                'type' => 'radio',
            ],
            '3-4' => [
                'title' => '短期記憶',
                'options' => ['できる', 'できない'],
                'type' => 'radio',
            ],
            '3-5' => [
                'title' => '自分の名前を言う',
                'options' => ['できる', 'できない'],
                'type' => 'radio',
            ],
            '3-6' => [
                'title' => '今の季節を理解',
                'options' => ['できる', 'できない'],
                'type' => 'radio',
            ],
            '3-7' => [
                'title' => '場所の理解',
                'options' => ['できる', 'できない'],
                'type' => 'radio',
            ],
            '3-8' => [
                'title' => '常時の徘徊',
                'options' => ['ない', 'ときどきある', 'ある'],
                'type' => 'radio',
            ],
            '3-9' => [
                'title' => '外出して戻れない',
                'options' => ['ない', 'ときどきある', 'ある'],
                'type' => 'radio',
            ],
            // 第4群
            '4-1' => [
                'title' => '被害的',
                'options' => ['ない', 'ときどきある', 'ある'],
                'type' => 'radio',
            ],
            '4-2' => [
                'title' => '作話',
                'options' => ['ない', 'ときどきある', 'ある'],
                'type' => 'radio',
            ],
            '4-3' => [
                'title' => '感情が不安定',
                'options' => ['ない', 'ときどきある', 'ある'],
                'type' => 'radio',
            ],
            '4-4' => [
                'title' => '昼夜逆転',
                'options' => ['ない', 'ときどきある', 'ある'],
                'type' => 'radio',
            ],
            '4-5' => [
                'title' => '同じ話をする',
                'options' => ['ない', 'ときどきある', 'ある'],
                'type' => 'radio',
            ],
            '4-6' => [
                'title' => '大声をだす',
                'options' => ['ない', 'ときどきある', 'ある'],
                'type' => 'radio',
            ],
            '4-7' => [
                'title' => '介護に抵抗',
                'options' => ['ない', 'ときどきある', 'ある'],
                'type' => 'radio',
            ],
            '4-8' => [
                'title' => '落ち着きなし',
                'options' => ['ない', 'ときどきある', 'ある'],
                'type' => 'radio',
            ],
            '4-9' => [
                'title' => '一人で出たがる',
                'options' => ['ない', 'ときどきある', 'ある'],
                'type' => 'radio',
            ],
            '4-10' => [
                'title' => '収集癖',
                'options' => ['ない', 'ときどきある', 'ある'],
                'type' => 'radio',
            ],
            '4-11' => [
                'title' => '物や衣類を隠す',
                'options' => ['ない', 'ときどきある', 'ある'],
                'type' => 'radio',
            ],
            '4-12' => [
                'title' => 'ひどい物忘れ',
                'options' => ['ない', 'ときどきある', 'ある'],
                'type' => 'radio',
            ],
            '4-13' => [
                'title' => '独り言・独り笑い',
                'options' => ['ない', 'ときどきある', 'ある'],
                'type' => 'radio',
            ],
            '4-14' => [
                'title' => '自分勝手に行動する',
                'options' => ['ない', 'ときどきある', 'ある'],
                'type' => 'radio',
            ],
            '4-15' => [
                'title' => '話がまとまらない',
                'options' => ['ない', 'ときどきある', 'ある'],
                'type' => 'radio',
            ],
            // 第5群
            '5-1' => [
                'title' => '薬の内服',
                'options' => ['自立（介助なし）', '一部介助', '全介助'],
                'type' => 'radio',
            ],
            '5-2' => [
                'title' => '金銭の管理',
                'options' => ['自立（介助なし）', '一部介助', '全介助'],
                'type' => 'radio',
            ],
            '5-3' => [
                'title' => '日常の意思決定',
                'options' => ['できる', '特別な場合を除いてできる', '日常的に困難', 'できない'],
                'type' => 'radio',
            ],
            '5-4' => [
                'title' => '集団参加ができない',
                'options' => ['ない', 'ときどきある', 'ある'],
                'type' => 'radio',
            ],
            '5-5' => [
                'title' => '買い物',
                'options' => ['できる（介助なし）', '見守り等', '一部介助', '全介助'],
                'type' => 'radio',
            ],
            '5-6' => [
                'title' => '簡単な調理',
                'options' => ['できる（介助なし）', '見守り等', '一部介助', '全介助'],
                'type' => 'radio',
            ],
            // 第6群
            '6-1' => [
                'title' => '処置内容',
                'options' => ['点滴の管理', '中心静脈栄養', '透析', 'ストーマ（人工肛門）の処置', '酸素両方', 'レスピレーター（人工呼吸器）', '気管切開の処置', '疼痛の看護', '経管栄養'],
                'type' => 'checkbox',
            ],
            '6-2' => [
                'title' => '特別な医療行為',
                'options' => ['モニター測定（血圧・心拍・酸素飽和度等）', 'じょくそうの処置', 'カテーテル（コンドームカテーテル・留置カテーテル・ウロストーマ等）'],
                'type' => 'checkbox',
            ],
            // 第7群
            '7-1' => [
                'title' => '障害高齢者自立度',
                'options' => ['自立', 'J1', 'J2', 'A1', 'A2', 'B1', 'B2', 'C1', 'C2'],
                'type' => 'radio',
            ],
            '7-2' => [
                'title' => '認知症高齢者自立度',
                'options' => ['自立', 'Ⅰ', 'Ⅱa', 'Ⅱb', 'Ⅲa', 'Ⅲb', 'Ⅳ', 'M'],
                'type' => 'radio',
            ],
            // 第8群
            '8-1' => [
                'title' => '日常の意思決定を行うための認知能力',
                'options' => ['自立', 'いくらか困難', '見守りが必要', '判断できない'],
                'type' => 'radio',
            ],
            '8-2' => [
                'title' => '自分の意思の伝達力',
                'options' => ['自立', 'いくらか困難', '具体的要求に限られる', '伝えられない'],
                'type' => 'radio',
            ],
            '8-3' => [
                'title' => '短期記憶',
                'options' => ['問題なし', '問題あり'],
                'type' => 'radio',
            ],
            '8-4' => [
                'title' => '食事自己動作',
                'options' => ['自立', 'なんとか自分で食べられる', '全面介助'],
                'type' => 'radio',
            ],
            '8-5' => [
                'title' => '認知症高齢者の日常生活自立度',
                'options' => ['自立', 'Ⅰ', 'Ⅱa', 'Ⅱb', 'Ⅲa', 'Ⅳ', 'M', '記載無し'],
                'type' => 'radio',
            ],
        ];
    }

    /**
     * 特定のグループに属する調査項目を取得
     * 
     * @param int $groupId グループID
     * @return array 指定したグループに属する調査項目の配列
     */
    public static function getQuestionsByGroup(int $groupId): array
    {
        $groupPrefix = $groupId . '-';
        $questions = [];

        foreach (self::getAllQuestions() as $key => $question) {
            if (str_starts_with($key, $groupPrefix)) {
                $questions[$key] = $question;
            }
        }

        return $questions;
    }

    /**
     * 中間得点データを取得する
     * 
     * @return array 中間得点データ
     */
    public static function getIntermediateScores(): array
    {
        return self::$intermediateScores;
    }

    /**
     * 特定の質問と回答に対応する中間得点を取得する
     * 
     * @param string $questionId 質問ID
     * @param string|array $answer 回答内容
     * @return float|null 中間得点（該当する得点がない場合はnull）
     */
    public static function getIntermediateScore(string $questionId, $answer): ?float
    {
        // チェックボックス（複数選択）の場合は特殊処理
        if (is_array($answer)) {
            // 麻痺の特殊処理
            if ($questionId === '1-1') {
                return self::calculateParalysisScore($answer);
            }
            // 拘縮の特殊処理
            else if ($questionId === '1-2') {
                return self::calculateContractionScore($answer);
            }
            // その他のチェックボックス項目は現時点では未実装
            return null;
        }
        // ラジオボタン（単一選択）の場合
        else {
            if (isset(self::$intermediateScores[$questionId][$answer])) {
                return self::$intermediateScores[$questionId][$answer];
            }
        }

        return null;
    }

    /**
     * 麻痺の中間得点を計算する
     * 
     * @param array $selectedOptions 選択された麻痺の部位
     * @return float 麻痺の中間得点
     */
    private static function calculateParalysisScore(array $selectedOptions): float
    {
        // 選択肢がない場合は「麻痺なし」として扱う
        if (empty($selectedOptions)) {
            return self::$intermediateScores['1-1']['ない'];
        }

        // 「その他（四肢欠損）」が選択されている場合
        if (in_array('その他（四肢欠損）', $selectedOptions)) {
            return self::$intermediateScores['1-1']['その他の四肢の麻痺'];
        }

        // 左上肢と左下肢、または右上肢と右下肢が選択されている場合
        if ((in_array('左上肢', $selectedOptions) && in_array('左下肢', $selectedOptions)) ||
            (in_array('右上肢', $selectedOptions) && in_array('右下肢', $selectedOptions))
        ) {
            return self::$intermediateScores['1-1']['左上下肢あるいは右上下肢'];
        }

        // 両下肢が選択されている場合
        if (in_array('左下肢', $selectedOptions) && in_array('右下肢', $selectedOptions)) {
            return self::$intermediateScores['1-1']['両下肢のみ'];
        }

        // いずれか一肢のみ選択されている場合
        if (count($selectedOptions) === 1) {
            return self::$intermediateScores['1-1']['いずれか一肢のみ'];
        }

        // その他の組み合わせの場合（複数の麻痺があるが特定のパターンに当てはまらない）
        return self::$intermediateScores['1-1']['その他の四肢の麻痺'];
    }

    /**
     * 拘縮の中間得点を計算する
     * 
     * @param array $selectedOptions 選択された拘縮の部位
     * @return float 拘縮の中間得点
     */
    private static function calculateContractionScore(array $selectedOptions): float
    {
        $score = 0;

        // 肩関節の拘縮がない場合
        if (!in_array('肩関節', $selectedOptions)) {
            $score += self::$intermediateScores['1-2_肩関節']['ない'];
        }

        // 股関節の拘縮がない場合
        if (!in_array('股関節', $selectedOptions)) {
            $score += self::$intermediateScores['1-2_股関節']['ない'];
        }

        // 膝関節の拘縮がない場合
        if (!in_array('膝関節', $selectedOptions)) {
            $score += self::$intermediateScores['1-2_膝関節']['ない'];
        }

        return $score;
    }
}
